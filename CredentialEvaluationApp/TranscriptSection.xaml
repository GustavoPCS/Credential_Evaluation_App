<UserControl x:Class="CredentialEvaluationApp.TranscriptSection"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:CredentialEvaluationApp"
             Height="Auto" Width="700"
             >
    <UserControl.Resources>
        <DataTemplate x:Key="DeleteButtonTemplate">
            <Button Content="Delete"
                Click="DeleteCourse_Click"
                Tag="{Binding}"
                FontSize="8"
                MaxHeight="10"
                MaxWidth="50"
                Padding="4,0"
                Background="#E57373"
                Foreground="White"
                HorizontalAlignment="Center"/>
        </DataTemplate>

        <local:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>

    </UserControl.Resources>




    <Border CornerRadius="10"
            HorizontalAlignment="Center"
            Background="White"
            Width="700"
            Margin="0,0,0,20">

        <StackPanel Orientation="Vertical"
                    Width="700"
                    Height="Auto">
            <StackPanel Orientation="Horizontal" Margin="15,15,0,0" HorizontalAlignment="Left">
                <TextBox Text="{Binding TranscriptTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         x:Name= "TranscriptTitleTextBox"
                         Margin="0,0,0,0"
                         FontFamily="pack://application:,,,/Fonts/#Quicksand"
                         FontWeight="SemiBold"
                         FontSize="15"
                         Background="Transparent"
                         BorderThickness="0"
                         Padding="0"
                         IsReadOnly="False"
                         Focusable="True"
                         Cursor="IBeam"/>
                <Button x:Name="DeleteButton"
                        Content="Delete"
                        Click="DeleteTranscript_Click"
                        FontSize="10"
                        Padding="0"
                        Margin="10,0,0,0"
                        Background="Transparent"
                        BorderThickness="0"
                        Foreground="Crimson"
                        Cursor="Hand"
                        VerticalAlignment="Center"
                        FontFamily="pack://application:,,,/Fonts/#Quicksand"
                        FontWeight="Regular"
                        Visibility="Visible"/>

            </StackPanel>

            <!-- Country Field -->
            <TextBlock Text="Country"
                       Margin="15,15,0,5"
                       FontFamily="pack://application:,,,/Fonts/#Quicksand"
                       FontWeight="Regular"
                       FontSize="11"/>
            <ComboBox x:Name="countryComboBox"
                      Width="150"
                      Height="22"
                      Margin="15,0,0,0"
                      FontSize="11"
                      FontFamily="pack://application:,,,/Fonts/#Quicksand"
                      IsEditable="True"
                      IsTextSearchEnabled="True"
                      StaysOpenOnEdit="True"
                      HorizontalAlignment="Left"
                      SelectionChanged="countryComboBox_SelectionChanged"/>

            <!-- Grading Scale Field -->
            <TextBlock Text="Grading Scale"
                       Margin="15,15,0,5"
                       FontFamily="pack://application:,,,/Fonts/#Quicksand"
                       FontWeight="Regular"
                       FontSize="11"/>
            <ComboBox x:Name="gradingScaleComboBox"
                      Width="150"
                      Height="22"
                      Margin="15,0,0,0"
                      FontSize="11"
                      FontFamily="pack://application:,,,/Fonts/#Quicksand"
                      IsEditable="True"
                      IsTextSearchEnabled="True"
                      StaysOpenOnEdit="True"
                      HorizontalAlignment="Left"
                      SelectionChanged="gradingScaleComboBox_SelectionChanged"/>

            <!-- Transcript DataGrid -->
            <ItemsControl ItemsSource="{Binding Semesters}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Margin="0,15,0,15">

                            <!-- Semester Header Row -->
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,0">
                                <!-- Semester Name -->
                                <TextBlock Text="{Binding SemesterName}"
                                           FontFamily="pack://application:,,,/Fonts/#Quicksand"
                                           FontSize="12"
                                           FontWeight="Regular"
                                           VerticalAlignment="Center"
                                           Margin="15,0,0,0"/>

                                <!-- Edit Toggle Button (per semester) -->
                                <Button Content="Edit"
                                        Click="ToggleEditMode_Click"
                                        FontSize="10"
                                        Padding="0"
                                        Margin="10,0,0,0"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Foreground="Purple"
                                        Cursor="Hand"
                                        VerticalAlignment="Center"
                                        FontFamily="pack://application:,,,/Fonts/#Quicksand"
                                        FontWeight="Regular"
                                        Tag="{Binding}" />

                                <Button x:Name="DeleteSemesterButton"
                                        Content="Delete"
                                        Click="DeleteSemester_Click"
                                        FontSize="10"
                                        Padding="0"
                                        Margin="10,0,0,0"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Foreground="Crimson"
                                        Cursor="Hand"
                                        VerticalAlignment="Center"
                                        FontFamily="pack://application:,,,/Fonts/#Quicksand"
                                        FontWeight="Regular"
                                        Visibility="{Binding IsEditMode, Converter={StaticResource BoolToVisibilityConverter}}" />

                            </StackPanel>

                            <!-- Semester DataGrid -->
                            <DataGrid x:Name="transcriptDataGrid" AutoGenerateColumns="False" CanUserAddRows="False" Margin="15,0,0,0" ItemsSource="{Binding Courses}" SelectionMode="Single" SelectionUnit="Cell" IsReadOnly="False" FontSize="10" HorizontalAlignment="Left" RowHeight="30" Style="{StaticResource MaterialDesignDataGrid}" RowStyle="{StaticResource MaterialDesignDataGridRow}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Course" Binding="{Binding CourseName}" Width="130"/>
                                    <DataGridTemplateColumn Header="Grade" Width="100">
                                        <DataGridTemplateColumn.CellStyle>
                                            <Style TargetType="DataGridCell" BasedOn="{StaticResource MaterialDesignDataGridCell}">
                                                <EventSetter Event="PreviewMouseLeftButtonDown" Handler="DataGridCell_PreviewMouseLeftButtonDown"/>
                                            </Style>
                                        </DataGridTemplateColumn.CellStyle>
                                        <DataGridTemplateColumn.CellEditingTemplate>
                                            <DataTemplate>
                                                <ComboBox ItemsSource="{Binding DataContext.AvailableGrades, RelativeSource={RelativeSource AncestorType=UserControl}}" SelectedItem="{Binding Grade, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellEditingTemplate>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Grade}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn Header="Credit Hours" Binding="{Binding CreditHours}" Width="100"/>

                                </DataGrid.Columns>
                            </DataGrid>

                            <!-- Add Course Button -->
                            <Button Content="Add Course"
                                    Width="95"
                                    Height="20"
                                    Margin="15,15,0,0"
                                    FontFamily="pack://application:,,,/Fonts/#Quicksand"
                                    FontSize="11"
                                    FontWeight="Regular"
                                    Background="#CCCCCC"
                                    Foreground="Black"
                                    BorderThickness="0"
                                    HorizontalAlignment="Left"
                                    Cursor="Hand"
                                    Tag="{Binding}"
                                    Click="AddCourse_Click">
                                <Button.Resources>
                                    <Style TargetType="Border">
                                        <Setter Property="CornerRadius" Value="7"/>
                                    </Style>
                                </Button.Resources>
                            </Button>

                        </StackPanel>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- Add Semester Button -->
            <Button Content="Add Semester"
                    Width="105"
                    Height="20"
                    Margin="15,20,0,10"
                    FontFamily="pack://application:,,,/Fonts/#Quicksand"
                    FontSize="11"
                    FontWeight="Regular"
                    Background="#CCCCCC"
                    Foreground="Black"
                    BorderThickness="0"
                    HorizontalAlignment="Left"
                    Cursor="Hand"
                    Click="AddSemester_Click">
                <Button.Resources>
                    <Style TargetType="Border">
                        <Setter Property="CornerRadius" Value="7"/>
                    </Style>
                </Button.Resources>
            </Button>

            <!-- Multiplier Field -->
            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Left"
                        Margin="15,15,0,10">

                <TextBlock Text="Multiplier :"
                           Margin="0,5,10,0"
                           FontFamily="pack://application:,,,/Fonts/#Quicksand"
                           FontWeight="Regular"
                           FontSize="11"/>
                <TextBox x:Name="MultiplierTextBox"
                         Width="40"
                         Height="25"
                         Margin="0,0,0,0"
                         FontSize="11"
                         FontFamily="pack://application:,,,/Fonts/#Quicksand"
                         Background="#F0F0F0"
                         BorderBrush="#CCCCCC"
                         BorderThickness="1"
                         HorizontalAlignment="Left"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Center"
                        Margin="0,0,0,20">

                <TextBlock Text="GPA: "
                           Margin="0,0"
                           FontFamily="pack://application:,,,/Fonts/#Quicksand"
                           FontWeight="Regular"
                           FontSize="15"/>

                <TextBlock x:Name="TranscriptGPATextBlock"
                           Text="0.00"
                           Margin="0,0"
                           FontFamily="pack://application:,,,/Fonts/#Quicksand"
                           FontWeight="Regular"
                           FontSize="15"/>

                <TextBlock Text="Credits: "
                           Margin="20,0,0,0"
                           FontFamily="pack://application:,,,/Fonts/#Quicksand"
                           FontWeight="Regular"
                           FontSize="15"/>

                <TextBlock x:Name="TranscriptCreditsTextBlock"
                           Text="0"
                           Margin="0,0"
                           FontFamily="pack://application:,,,/Fonts/#Quicksand"
                           FontWeight="Regular"
                           FontSize="15"/>
            </StackPanel>

        </StackPanel>
    </Border>
</UserControl>

